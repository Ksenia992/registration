(()=>{"use strict";class e extends HTMLElement{constructor(){super()}addElement(e){return this.shadow.appendChild(document.createElement(e))}getCurrentUserProp(e,t){return sessionStorage.get("currentUser").propName||t}async getUsers(){this.users=await(await fetch("http://localhost:3000/users")).json()}async saveUsers(){(await(await fetch("http://localhost:3000/users")).json()).forEach((e=>localStorage.set(e.name,{id:e.id,password:e.password})))}}customElements.define("base-class",e);const t=e;class n extends t{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"});const e=this.addElement("figure");this.addElement("style").textContent=this.css,e.innerHTML=this.template}connectedCallback(){this.saveUsers();const[e,t,n]=["#login","#password","#button"].map((e=>this.shadow.querySelector(e)));e.oninput=function(e){const n=localStorage.get(e.target.value);e.target.style.color=n?"#090":"#f00",t.disabled=!n},t.oninput=function(t){const{password:o}=localStorage.get(e.value);t.target.style.color=o===t.target.value?"#090":"#f00",n.disabled=o!==t.target.value},n.onclick=function(t){document.getElementById("authorization").remove();const n=localStorage.get(e.value);fetch(`http://localhost:3000/users/${n.id}`).then((e=>e.json())).then((e=>{sessionStorage.set("currentUser",Object.assign({},e,{lastVisit:(new Date).toLocaleString()}))})),document.body.appendChild(document.createElement("p")).id="success_in",success_in.innerHTML="You have succesfully signed in!",success_in.style.color="#FF69B4",setTimeout((function(){success_in.style.display="none"}),3e3)}}}n.prototype.css="\n  figure {\n    position: absolute;\n    width: 502px;\n    left: 50%;\n    transform: translateX(-50%);\n    height: 300px;\n    padding: 32px;\n    box-shadow: 8px 8px 16px #0007;\n    background: #C71585;\n    border: 1px solid #ddd;\n    box-sizing: border-box;\n  }\n  input, button {\n    display: block;\n    width: 400px;\n    padding: 8px 16px;\n    margin: 32px auto;\n    font-size: 16px;\n    font-family: Arial;\n    outline:none;\n    border:1px solid;\n    border-radius:6px;\n    color:#C71585;\n  }\n  #button {\n    cursor:pointer;\n  }\n",n.prototype.template='\n  <input id="login" placeholder="User Name">\n  <input type="password" id="password" placeholder="Password" disabled>\n  <button id="button" disabled>Sign In</button>\n',customElements.define("sign-in",n);class o extends t{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"});const e=this.addElement("figure");this.addElement("style").textContent=this.css,e.innerHTML=this.template,this.users=null}connectedCallback(){this.getUsers();const[e,t,n,o,s]=["#login","#password","#avatarImage","#avatar","#button"].map((e=>this.shadow.querySelector(e)));e.oninput=function(e){const n=localStorage.get(e.target.value);e.target.style.color=n?"#f00":"#090",t.disabled=!!n},t.oninput=function(e){e.target.style.color=e.target.value.length>=8?"#090":"#f00",s.disabled=e.target.value.length<8},s.onclick=function(o){document.getElementById("registration").remove(),localStorage.set(e.value,{name:e.value,password:t.value});const s=Object.assign({},localStorage.get(e.value),{avatar:n.src});fetch("http://localhost:3000/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),document.body.appendChild(document.createElement("p")).id="success_up",success_up.innerHTML="You have succesfully signed up!",success_up.style.color="#FF69B4",setTimeout((function(){success_up.style.display="none"}),3e3)},o.onchange=function(e){const t=new FileReader;t.onload=function(e){n.src=e.target.result},t.readAsDataURL(e.target.files[0])}}}o.prototype.css="\n  figure {\n    position: absolute;\n    width: 502px;\n    left: 50%;\n    transform: translateX(-50%);\n    padding: 32px;\n    box-shadow: 8px 8px 16px #0007;\n    background: #C71585;\n    border: 1px solid #ddd;\n    box-sizing: border-box;\n  }\n  input, button {\n    display: block;\n    width: 400px;\n    padding: 8px 16px;\n    margin: 32px auto;\n    font-size: 16px;\n    font-family: Arial;\n    outline:none;\n    border:1px solid;\n    border-radius:6px;\n    color:#C71585;\n  }\n  img {\n    width: 100px;\n  }\n  #button {\n    cursor:pointer;\n  }\n  input[type=file] {\n    outline:0;\n    opacity:0;\n    pointer-events:none;\n    user-select:none;\n  }\n .label { \n   width:62px;\n   height:32px;\n   border:2px solid #FF69B4;\n   border-radius:5px;\n   display:block;\n   padding:1.2em;\n   transition:border 300ms ease;\n   cursor:pointer;\n  }\n .label i {\n   display:block;\n   font-size:18px;\n  }\n .label i, .label .title {\n   color:pink;\n   transition:200ms color\n  }\n .label:hover {\n   border:2px solid #EE82EE;\n  }\n \n",o.prototype.template='\n  <input id="login" placeholder="User Name">\n  <input type="password" id="password" placeholder="Password" disabled>\n  <img id="avatarImage" src="assets/kitty.png">\n  <label class="label">\n      <i class="material-icons">Choose photo</i>\n      <input type="file" id="avatar">\n    </label>\n  <button id="button" disabled>Sign Up</button>\n',customElements.define("sign-up",o);class s extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"closed"}),this.shadow.appendChild(document.createElement("figure")).innerHTML='\n      <style>\n        figure {\n          text-align: center;\n          max-width: 600px;\n          margin: 0 auto;\n          border: 1px solid #999;\n        }\n        img {\n          width: 300px;\n        }\n      </style>\n      <input id="input-photo" type="file">\n      <img id="photo" src="assets/hello.jpg">\n      \n    '}connectedCallback(){const[e,t]=["#input-photo","#photo"].map((e=>this.shadow.querySelector(e)));e.onchange=function(e){const n=new FileReader;n.onload=function(e){t.src=e.target.result,fetch("http://localhost:3000/photos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:sessionStorage.get("currentUser").id,photo:e.target.result})})},n.readAsDataURL(e.target.files[0])}}}customElements.define("upload-photo",s),document.getElementById("sign-in").onclick=function(e){document.body.appendChild(document.createElement("sign-in")).id="authorization",registration.remove()},document.getElementById("sign-up").onclick=function(e){document.body.appendChild(document.createElement("sign-up")).id="registration",authorization.remove()}})();